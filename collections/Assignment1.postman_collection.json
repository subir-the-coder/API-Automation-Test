{
  "info": {
    "_postman_id": "c1bf166f-4f5a-40a5-b3b9-0145bd794c70",
    "name": "Assignment #1",
    "description": "Postman Collection for Assignment #1 - API Automation Tasks",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "API requests",
      "item": [
        {
          "name": "Get API status",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              { "key": "Accept", "value": "application/json" },
              { "key": "x-api-key", "value": "{{postman_api_key}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["status"]
            },
            "description": "Retrieve the current status of the API"
          }
        },
        {
          "name": "Get single product",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "let responseData = pm.response.json();",
                  "console.log(responseData[\"product-description\"]);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              { "key": "Accept", "value": "application/json" },
              { "key": "x-api-key", "value": "{{postman_api_key}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/products/:productId",
              "host": ["{{baseUrl}}"],
              "path": ["products", ":productId"],
              "variable": [
                { "key": "productId", "value": "1001" }
              ]
            },
            "description": "Retrieve a single product by ID"
          }
        },
        {
          "name": "Create a new order",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "let newOrder = pm.response.json();",
                  "console.log(newOrder.id);",
                  "pm.test(\"Order created successfully\", function () {",
                  "    pm.collectionVariables.set(\"orderId\", newOrder.id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Accept", "value": "application/json" },
              { "key": "x-api-key", "value": "{{postman_api_key}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"{{$randomFullName}}\",\n  \"products\": [\n    { \"id\": 2001, \"quantity\": 1 },\n    { \"id\": 2002, \"quantity\": 3 }\n  ]\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": {
              "raw": "{{baseUrl}}/orders",
              "host": ["{{baseUrl}}"],
              "path": ["orders"]
            },
            "description": "Place a new order"
          }
        }
      ]
    },
    {
      "name": "Check your solution",
      "item": [
        {
          "name": "Verify your work",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "let collection = pm.response.json().collection;",
                  "pm.test(\"If you have any failures, review the failed test results or ask for support in the community forum. Remember to save your changes if you update the collection.\", () => { pm.expect(true); });",
                  "pm.test(\"Status code is 200\", () => { pm.response.to.have.status(200); });",
                  "pm.test(\"Correct collection returned\", () => { pm.expect(collection.info.name).contains(\"Assignment #1\"); });",
                  "pm.test(\"API key secure\", () => { let apiKey = collection.variable.find(item => item.key === \"postman_api_key\"); pm.expect(apiKey.value, 'API key visible under Initial value').does.not.include(\"PMAK\"); });",
                  "let folder = collection.item.find(fol => fol.name === \"API requests\");",
                  "pm.test(\"Requests added correctly\", () => { pm.expect(folder.item.length, 'check number of requests').equals(3); pm.expect(folder.item.find(req => req.name === \"Get API status\").name).equals(\"Get API status\"); pm.expect(folder.item.find(req => req.name === \"Get single product\").name).equals(\"Get single product\"); pm.expect(folder.item.find(req => req.name === \"Create a new order\").name).equals(\"Create a new order\"); });",
                  "pm.test(\"Get API status contains status 200 test\", () => { let request = folder.item.find(req => req.name === \"Get API status\"); pm.expect(request.event).to.be.an('array'); let tests = request.event.find(event => event.listen === 'test'); pm.expect(tests).to.be.an('object'); pm.expect(tests.script.exec.toString()).includes(\"pm.test\"); pm.expect(tests.script.exec.toString()).includes(\"pm.response.to.have.status\"); });",
                  "pm.test(\"Get single product parses the response body and logs a value to the Postman console\", () => { let request = folder.item.find(req => req.name === \"Get single product\"); pm.expect(request.event).to.be.an('array'); let tests = request.event.find(event => event.listen === 'test'); pm.expect(tests).to.be.an('object'); pm.expect(tests.script.exec.toString()).includes(\"pm.response.json()\"); pm.expect(tests.script.exec.toString()).includes(\"console.log\"); pm.expect(tests.script.exec.toString()).includes(\"product-description\"); });",
                  "pm.test(\"Create a new order sets a Postman variable\", () => { let request = folder.item.find(req => req.name === \"Create a new order\"); pm.expect(request.event).to.be.an('array'); let tests = request.event.find(event => event.listen === 'test'); pm.expect(tests).to.be.an('object'); pm.expect(tests.script.exec.toString()).includes(\"pm.response.json()\"); pm.expect(tests.script.exec.toString()).includes(\"pm.collectionVariables.set\"); });"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              { "key": "x-api-key", "value": "{{postman_api_key}}" }
            ],
            "url": {
              "raw": "https://api.getpostman.com/collections/:collectionId?apikey={{postman_api_key}}",
              "protocol": "https",
              "host": ["api","getpostman","com"],
              "path": ["collections",":collectionId"],
              "variable": [
                { "key": "collectionId", "value": "{{collection_uuid}}" }
              ]
            },
            "description": "Verify your collection on Postman API"
          }
        }
      ]
    }
  ],
  "variable": [
    { "key": "postman_api_key", "value": "" },
    { "key": "collection_uuid", "value": "" },
    { "key": "baseUrl", "value": "https://valentinos-coffee.herokuapp.com" }
  ]
}
